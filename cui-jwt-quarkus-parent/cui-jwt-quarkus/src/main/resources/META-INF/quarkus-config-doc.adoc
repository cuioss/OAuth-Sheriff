= CUI JWT Quarkus Extension Configuration Reference

This document describes the configuration options available for the CUI JWT Quarkus extension.

== Global Configuration

[cols="2,1,5"]
|===
|Property |Type |Description

|cui.jwt.parser.audience
|Optional<String>
|The expected audience claim value. If specified, the JWT must contain this value in its "aud" claim.

|cui.jwt.parser.leewaySeconds
|int (default: 30)
|The leeway in seconds to allow for clock skew when validating expiration and not-before claims.

|cui.jwt.parser.maxTokenSizeBytes
|int (default: 8192)
|The maximum token size in bytes. Tokens larger than this will be rejected.

|cui.jwt.parser.validateNotBefore
|boolean (default: true)
|Whether to validate the "nbf" (not before) claim.

|cui.jwt.parser.validateExpiration
|boolean (default: true)
|Whether to validate the "exp" (expiration) claim.

|cui.jwt.parser.validateIssuedAt
|boolean (default: false)
|Whether to validate the "iat" (issued at) claim.

|cui.jwt.parser.allowedAlgorithms
|String (default: "RS256,RS384,RS512,ES256,ES384,ES512")
|Comma-separated list of allowed signing algorithms.
|===

== Issuer Configuration

The extension supports multiple issuers, each with its own configuration. Replace `<issuer-name>` with your issuer identifier.

[cols="2,1,5"]
|===
|Property |Type |Description

|cui.jwt.issuers.<issuer-name>.url
|String (required)
|The issuer URL/identifier that will be matched against the "iss" claim in the JWT.

|cui.jwt.issuers.<issuer-name>.publicKeyLocation
|Optional<String>
|Location of the public key or certificate used to verify tokens from this issuer. This can be a file path, URL, or classpath resource.

|cui.jwt.issuers.<issuer-name>.enabled
|boolean (default: true)
|Whether this issuer configuration is enabled.
|===

== Issuer-Specific Parser Configuration

Each issuer can override the global parser configuration with its own settings.

[cols="2,1,5"]
|===
|Property |Type |Description

|cui.jwt.issuers.<issuer-name>.parser.audience
|Optional<String>
|The expected audience claim value for this issuer.

|cui.jwt.issuers.<issuer-name>.parser.leewaySeconds
|int
|The leeway in seconds for this issuer.

|cui.jwt.issuers.<issuer-name>.parser.maxTokenSizeBytes
|int
|The maximum token size in bytes for this issuer.

|cui.jwt.issuers.<issuer-name>.parser.validateNotBefore
|boolean
|Whether to validate the "nbf" claim for this issuer.

|cui.jwt.issuers.<issuer-name>.parser.validateExpiration
|boolean
|Whether to validate the "exp" claim for this issuer.

|cui.jwt.issuers.<issuer-name>.parser.validateIssuedAt
|boolean
|Whether to validate the "iat" claim for this issuer.

|cui.jwt.issuers.<issuer-name>.parser.allowedAlgorithms
|String
|Comma-separated list of allowed signing algorithms for this issuer.
|===

== JWKS Configuration

Each issuer can have a JWKS (JSON Web Key Set) endpoint configuration.

[cols="2,1,5"]
|===
|Property |Type |Description

|cui.jwt.issuers.<issuer-name>.jwks.url
|String (required)
|The URL of the JWKS endpoint.

|cui.jwt.issuers.<issuer-name>.jwks.cacheTtlSeconds
|int (default: 3600)
|The cache time-to-live in seconds for the JWKS response.

|cui.jwt.issuers.<issuer-name>.jwks.refreshIntervalSeconds
|int (default: 300)
|The refresh interval in seconds for the JWKS cache.

|cui.jwt.issuers.<issuer-name>.jwks.connectionTimeoutMs
|int (default: 5000)
|The connection timeout in milliseconds for the JWKS endpoint.

|cui.jwt.issuers.<issuer-name>.jwks.readTimeoutMs
|int (default: 5000)
|The read timeout in milliseconds for the JWKS endpoint.

|cui.jwt.issuers.<issuer-name>.jwks.maxRetries
|int (default: 3)
|The maximum number of retries for failed JWKS requests.

|cui.jwt.issuers.<issuer-name>.jwks.useSystemProxy
|boolean (default: false)
|Whether to use HTTP proxy settings from the system properties.
|===

== Example Configuration

[source,properties]
----
# Global parser configuration
cui.jwt.parser.leewaySeconds=30
cui.jwt.parser.maxTokenSizeBytes=8192
cui.jwt.parser.validateNotBefore=true
cui.jwt.parser.validateExpiration=true
cui.jwt.parser.validateIssuedAt=false
cui.jwt.parser.allowedAlgorithms=RS256,RS384,RS512,ES256,ES384,ES512

# Keycloak issuer configuration
cui.jwt.issuers.keycloak.url=https://keycloak.example.com/auth/realms/master
cui.jwt.issuers.keycloak.publicKeyLocation=classpath:keys/public_key.pem
cui.jwt.issuers.keycloak.enabled=true

# JWKS configuration for Keycloak
cui.jwt.issuers.keycloak.jwks.url=https://keycloak.example.com/auth/realms/master/protocol/openid-connect/certs
cui.jwt.issuers.keycloak.jwks.cacheTtlSeconds=7200
cui.jwt.issuers.keycloak.jwks.refreshIntervalSeconds=600
cui.jwt.issuers.keycloak.jwks.connectionTimeoutMs=3000
cui.jwt.issuers.keycloak.jwks.readTimeoutMs=3000
cui.jwt.issuers.keycloak.jwks.maxRetries=5
cui.jwt.issuers.keycloak.jwks.useSystemProxy=true

# Parser configuration for Keycloak
cui.jwt.issuers.keycloak.parser.audience=my-app
cui.jwt.issuers.keycloak.parser.leewaySeconds=60
cui.jwt.issuers.keycloak.parser.maxTokenSizeBytes=16384
cui.jwt.issuers.keycloak.parser.validateNotBefore=false
cui.jwt.issuers.keycloak.parser.validateExpiration=true
cui.jwt.issuers.keycloak.parser.validateIssuedAt=true
cui.jwt.issuers.keycloak.parser.allowedAlgorithms=RS256,ES256
----